<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üìù Criar Conta - Sistema de Loterias</title>
    <!-- ‚úÖ ADICIONAR ESTA LINHA: -->
    <script src="js/config.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .registro-container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 400px;
        width: 100%;
      }

      .logo {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo-icon {
        font-size: 4rem;
        margin-bottom: 10px;
      }

      h1 {
        font-size: 2rem;
        color: #667eea;
        text-align: center;
        margin-bottom: 10px;
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        color: #333;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      input {
        width: 100%;
        padding: 15px;
        border: 2px solid #ddd;
        border-radius: 10px;
        font-size: 1rem;
        transition: border-color 0.3s;
      }

      input:focus {
        outline: none;
        border-color: #667eea;
      }

      .btn-registro {
        width: 100%;
        padding: 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        margin-top: 10px;
      }

      .btn-registro:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
      }

      .btn-registro:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
      }

      .divider {
        text-align: center;
        margin: 25px 0;
        color: #999;
        position: relative;
      }

      .divider::before,
      .divider::after {
        content: "";
        position: absolute;
        top: 50%;
        width: 40%;
        height: 1px;
        background: #ddd;
      }

      .divider::before {
        left: 0;
      }

      .divider::after {
        right: 0;
      }

      .link-login {
        text-align: center;
        color: #666;
        margin-top: 20px;
      }

      .link-login a {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
      }

      .link-login a:hover {
        text-decoration: underline;
      }

      .alert {
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: none;
      }

      .alert-error {
        background: #ffebee;
        color: #c62828;
        border: 1px solid #ef5350;
      }

      .alert-success {
        background: #e8f5e9;
        color: #2e7d32;
        border: 1px solid #66bb6a;
      }

      .password-toggle {
        position: relative;
      }

      .toggle-icon {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        font-size: 1.2rem;
        color: #999;
      }

      .senha-info {
        font-size: 0.85rem;
        color: #999;
        margin-top: 5px;
      }

      @media (max-width: 480px) {
        .registro-container {
          padding: 30px 20px;
        }

        h1 {
          font-size: 1.5rem;
        }

        .logo-icon {
          font-size: 3rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="registro-container">
      <div class="logo">
        <div class="logo-icon">üé∞</div>
        <h1>Criar Conta</h1>
        <div class="subtitle">Cadastre-se para come√ßar</div>
      </div>

      <div class="alert alert-error" id="alert-erro"></div>
      <div class="alert alert-success" id="alert-sucesso"></div>

      <form id="form-registro" onsubmit="criarConta(event)">
        <div class="form-group">
          <label for="nome">Nome Completo:</label>
          <input
            type="text"
            id="nome"
            required
            placeholder="Seu nome"
            autocomplete="name"
            minlength="3"
          />
        </div>

        <div class="form-group">
          <label for="email">Email:</label>
          <input
            type="email"
            id="email"
            required
            placeholder="seu@email.com"
            autocomplete="email"
          />
        </div>

        <div class="form-group">
          <label for="senha">Senha:</label>
          <div class="password-toggle">
            <input
              type="password"
              id="senha"
              required
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              autocomplete="new-password"
              minlength="6"
            />
            <span class="toggle-icon" onclick="toggleSenha('senha')">üëÅÔ∏è</span>
          </div>
          <div class="senha-info">M√≠nimo 6 caracteres</div>
        </div>

        <div class="form-group">
          <label for="confirmar-senha">Confirmar Senha:</label>
          <div class="password-toggle">
            <input
              type="password"
              id="confirmar-senha"
              required
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              autocomplete="new-password"
              minlength="6"
            />
            <span class="toggle-icon" onclick="toggleSenha('confirmar-senha')"
              >üëÅÔ∏è</span
            >
          </div>
        </div>

        <button type="submit" class="btn-registro" id="btn-registro">
          üìù Criar Conta
        </button>
      </form>

      <div class="divider">ou</div>

      <div class="link-login">
        J√° tem conta? <a href="login.html">Fazer login</a>
      </div>
    </div>

    <script>
      // Toggle mostrar/ocultar senha
      function toggleSenha(inputId) {
        const senhaInput = document.getElementById(inputId);
        const toggleIcon = senhaInput.nextElementSibling;

        if (senhaInput.type === "password") {
          senhaInput.type = "text";
          toggleIcon.textContent = "üôà";
        } else {
          senhaInput.type = "password";
          toggleIcon.textContent = "üëÅÔ∏è";
        }
      }

      // Criar conta
      async function criarConta(event) {
        event.preventDefault();

        const nome = document.getElementById("nome").value.trim();
        const email = document.getElementById("email").value.trim();
        const senha = document.getElementById("senha").value;
        const confirmarSenha = document.getElementById("confirmar-senha").value;
        const btnRegistro = document.getElementById("btn-registro");
        const alertErro = document.getElementById("alert-erro");
        const alertSucesso = document.getElementById("alert-sucesso");

        // Limpar alertas
        alertErro.style.display = "none";
        alertSucesso.style.display = "none";

        // Validar senhas iguais
        if (senha !== confirmarSenha) {
          alertErro.textContent = "As senhas n√£o coincidem";
          alertErro.style.display = "block";
          return;
        }

        // Desabilitar bot√£o
        btnRegistro.disabled = true;
        btnRegistro.textContent = "‚è≥ Criando conta...";

        try {
          const response = await fetch(`${API_URL}/api/auth/registro`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ nome, email, senha }),
          });

          const data = await response.json();

          if (data.success) {
            // Salvar token no localStorage
            localStorage.setItem("token", data.data.token);
            localStorage.setItem("usuario", JSON.stringify(data.data.usuario));

            // Mostrar sucesso
            alertSucesso.textContent =
              "‚úÖ Conta criada com sucesso! Redirecionando...";
            alertSucesso.style.display = "block";

            // Redirecionar para dashboard
            setTimeout(() => {
              window.location.href = "index.html";
            }, 1500);
          } else {
            // Mostrar erro
            alertErro.textContent = data.message || "Erro ao criar conta";
            alertErro.style.display = "block";

            btnRegistro.disabled = false;
            btnRegistro.textContent = "üìù Criar Conta";
          }
        } catch (error) {
          console.error("Erro:", error);
          alertErro.textContent = "‚ùå Erro ao conectar com o servidor";
          alertErro.style.display = "block";

          btnRegistro.disabled = false;
          btnRegistro.textContent = "üìù Criar Conta";
        }
      }

      // Verificar se j√° est√° logado
      window.addEventListener("DOMContentLoaded", () => {
        const token = localStorage.getItem("token");
        if (token) {
          // J√° est√° logado, redirecionar
          window.location.href = "index.html";
        }
      });
    </script>
  </body>
</html>
